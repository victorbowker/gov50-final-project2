---
title: "Gov 50 Final Project"
author: "Victor Bowker"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---
F_AGECAT



## Project Plan

How do Democrats and Republicans compare on their fear of the economic future? I hypothesize the data will show that Democrats, who are currently represented by the current President, will feel more positive towards their future, as their leader is likely doing what they desire. Republicans are likely to feel that with the current leader is not representing their values and is impacting the economics negatively. This data could be compared with older data from a time when the White House was represented by a Republican, to test this hypothesis. My data set comes from Pew Research Center American Trends Poll from June 27th to July 4th of 2022. The explanatory variables will be the status of a polled person, whether they are Republican, Democrat, or Independent, coming from the F_Party_Final variable. My outcome variable will be the feeling of economic stability from the following variables - ECONCONC_INFL_W110, ECONCONC_UNEM_W110, ECONCONC_LAB_W110, ECONCONC_ENG_W110, ECONCONC_SHTG_W110, ECONCONC_REAL_W110, ECONCONC_STCK_W110. My hypothesis will be supported by data that indicates Democrats are more confident than Republicans in their economic status when a Democrat leader is in office. 

To test the data set, see code and a graph below. This plot demonstrates the approval proportion of Pres. Biden between Republicans and Democrats, as well as Men and Women. 


```{r}
##load and label data set
library(tidyverse)
library(haven)
dat <- read_sav("W110_Jun22/ATP W110.sav")
dat1 <- read_sav("W110_Jun22/ATP W110.sav")
altdat <- read_sav("W52_Jul19/ATP W52.sav")

```
```{r}
##simplify variable names, mutate new variables
dat <- dat |>
  mutate(
    Party = if_else(PARTY_W110 == 1, "Republican", "Democrat"), 
    Approval = if_else(POL1JB_W110 == 1, "Approve", "Disapprove"),
    Gender = if_else(F_GENDER == 1, "Man", "Woman"),
    Age = if_else(
      F_AGECAT == 1, "18-29",
      if_else(F_AGECAT == 2, "30-49",
        if_else(F_AGECAT == 3, "50-64",
          if_else(F_AGECAT == 4, "65+", "N/A"))))) |>
  group_by(Gender, Party) |>
  summarize(count = n()) |>
  mutate(proportion = count/sum(count))

##graph time
plots <- 
  dat |>
  ggplot(mapping = aes(x = Party, y = proportion, fill = Gender)) +
  geom_col(position = "dodge") +
  labs(title = "Approval Rating of Pres. Biden Based on Party and Gender", 
       x = "Respondent's Party",
       y = "Proportion of Respondents") 
plots

```

```{r}
infl <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  group_by(Party, Gender) |>
  summarize(mean_support = mean(ECONCONC_INFL_W110))
```
```{r}
infl_graph <-
  infl |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_INFL_W110")

infl_graph
```


ECONCONC_INFL_W110,
ECONCONC_UNEM_W110,
ECONCONC_LAB_W110,
ECONCONC_ENG_W110,
ECONCONC_SHTG_W110,
ECONCONC_REAL_W110,
ECONCONC_STCK_W110)


  mutate(support_level = case_when(ECONCONC_INFL_W110 == 1 ~ "A Lot",
                   ECONCONC_INFL_W110 == 2 ~ "Some",
                   ECONCONC_INFL_W110 == 3 ~ "Not Much",
                   ECONCONC_INFL_W110 == 4 ~ "Nothing At All"))

```{r}
unem <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  group_by(Party, Gender) |>
  summarize(mean_support = mean(ECONCONC_UNEM_W110))
```

```{r}
unem_graph <-
  unem |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_UNEM_W110")

unem_graph
```


```{r}
lab <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  group_by(Party, Gender) |>
  summarize(mean_support = mean(ECONCONC_LAB_W110))
```

```{r}
lab_graph <-
  lab |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_LAB_W110")

lab_graph
```
```{r}
eng <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  group_by(Party, Gender) |>
  summarize(mean_support = mean(ECONCONC_ENG_W110))
```

```{r}
eng_graph <-
  eng |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_ENG_W110")

eng_graph
```

```{r}
shtg <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  group_by(Party, Gender) |>
  summarize(mean_support = mean(ECONCONC_SHTG_W110))
```

```{r}
shtg_graph <-
  shtg |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_SHTG_W110")

shtg_graph
```

```{r}
real <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  group_by(Party, Gender) |>
  summarize(mean_support = mean(ECONCONC_REAL_W110))
```

```{r}
real_graph <-
  real |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_REAL_W110")

real_graph
```





```{r}
stck <-
  dat1 |>
  mutate(Party = if_else(PARTY_W110 == 1, "Republican", "Democrat")) |>
  mutate(Gender = if_else(F_GENDER == 1, "Man", "Woman")) |>
  mutate(Age = if_else(
      F_AGECAT == 1, "18-29",
      if_else(F_AGECAT == 2, "30-49",
        if_else(F_AGECAT == 3, "50-64",
          if_else(F_AGECAT == 4, "65+", "N/A"))))) |>
  
  group_by(Party, Gender, Age) |>
  summarize(mean_support = mean(ECONCONC_STCK_W110))
```

```{r}
stck_graph <-
  stck |>
  ggplot(mapping = aes(x = Party, y = mean_support, fill = Gender)) +
  geom_col(position = "dodge") + 
  labs(title = "ECONCONC_STCK_W110")

stck_graph
```
```{r}
fit.stck <-
  lm(mean_support ~ Party + Gender, data = stck)
fit.stck
```
```{r}
test_scatter <-
  stck |>
  ggplot(mapping = aes(x = mean_support, y = Age)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, col = "steelblue")
  
test_scatter

```


---
output:
  pdf_document: default
  html_document: default
---
##prep work
```{r}
##loading data and identifying data sets
library(tidyverse)
library(haven)
dat <- read_sav("W110_Jun22/ATP W110.sav")
dat1 <- read_sav("W110_Jun22/ATP W110.sav")
altdat <- read_sav("W52_Jul19/ATP W52.sav")
altdat1 <- read_sav("W52_Jul19/ATP W52.sav")
```

```{r}
##mutating to simplify label names
dat <- dat |>
  mutate(
    Party = if_else(PARTY_W110 == 1, "Republican", "Democrat"), 
    Approval = if_else(POL1JB_W110 == 1, "Approve", "Disapprove"),
    Gender = if_else(F_GENDER == 1, "Man", "Woman"),
    Age = if_else(
      F_AGECAT == 1, "18-29",
      if_else(F_AGECAT == 2, "30-49",
        if_else(F_AGECAT == 3, "50-64",
          if_else(F_AGECAT == 4, "65+", "N/A")))))
```

```{r}
##mutating to simplify label names
altdat <- 
  altdat |>
  mutate(
    Party = if_else(F_PARTY_FINAL == 1, "Republican", "Democrat"), 
    Gender = if_else(F_SEX == 1, "Man", "Woman"),
    Approval = if_else(POL1DT_W52 == 1, "Approve", "Disapprove"), 
    Age = if_else(
      F_AGECAT == 1, "18-29",
      if_else(F_AGECAT == 2, "30-49",
        if_else(F_AGECAT == 3, "50-64",
          if_else(F_AGECAT == 4, "65+", "N/A")))))
```

##begin analysis 1
```{r}
##combine biden era and trump era data
##independently researched this method

combodat <- bind_rows(
  mutate(dat, dataset = "Biden 1st Term"),
  mutate(altdat, dataset = "Trump 1st Term"))

## summarize data to what we need
summdat1 <- combodat |>
  group_by(Approval, Party, Gender, dataset) |>
  summarize(count = n()) |>
  mutate(altmean = count / sum(count))

```

```{r}
##graphing approval first
ggplot(summdat1, aes(x = Approval, y = altmean, fill = Party)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_grid(rows = vars(Gender), cols = vars(dataset)) +
  labs(title = "Approval Ratings by Party, Gender, and President",
       x = "Approval",
       y = "Proportion") +
  scale_fill_manual(values = c(Democrat = "steelblue1", Republican = "indianred1"))
```
##analysis 2
```{r}
##summarize data to what we need
summdat2 <- combodat |>
    group_by(Approval, Party, Gender,ECON1_W52, ECON1_W110, dataset)

```
```{r}
summdat2 <-
  summdat2 |>
  filter(ECON1_W52 == 1 | ECON1_W52 == 2 | ECON1_W52 == 3 | ECON1_W52 == 4 | 
           ECON1_W110 == 1 | ECON1_W110 == 2 | ECON1_W110 == 3 | ECON1_W110 == 4) |>
  mutate(ECON1_W52 = if_else(ECON1_W52 == 1, "Excellent",
                             if_else(ECON1_W52 == 2, "Good",
                                     if_else(ECON1_W52 == 3, "Only Fair",
                                             if_else(ECON1_W52 == 4, "Poor", "N/A"))))) |>
    mutate(ECON1_W110 = if_else(ECON1_W110 == 1, "Excellent",
                             if_else(ECON1_W110 == 2, "Good",
                                     if_else(ECON1_W110 == 3, "Only Fair",
                                            if_else(ECON1_W110 == 4, "Poor", "N/A"))))) |>
    mutate(ECON1B_W52 = if_else(ECON1B_W52 == 1, "Better",
                             if_else(ECON1B_W52 == 2, "Worse",
                                     if_else(ECON1B_W52 == 3, "About Same", "N/A")))) |>
    mutate(ECON1B_W110 = if_else(ECON1B_W110 == 1, "Better",
                             if_else(ECON1B_W110 == 2, "Worse",
                                     if_else(ECON1B_W110 == 3, "About Same", "N/A"))))
```
```{r}
avg_response_52 <-
  summdat2 |>
  group_by(ECON1_W52, Gender, Party) |>
  summarize(count1 = n()) |>
  mutate(avg = count1 / sum(count1)) |>
  ggplot(mapping = aes(x = Party, y = avg, fill = Gender)) +
  geom_col()






```
```{r}
##trump
avg_response_52 <- summdat2 %>%
  group_by(ECON1_W52, Gender, Party) %>%
  summarize(count1 = n()) %>%
  mutate(avg = count1 / sum(count1)) %>%
  ggplot(mapping = aes(x = ECON1_W52, y = avg, fill = Party)) +
  geom_col(position = "dodge") +
  labs(title = "Average Responses by Party, Gender, and ECON1_W52",
       x = "ECON1_W52",
       y = "Proportion")
avg_response_52
```


```{r}
##biden
avg_response_110 <- summdat2 %>%
  group_by(ECON1_W110, Gender, Party) %>%
  summarize(count1 = n()) %>%
  mutate(avg = count1 / sum(count1)) %>%
  ggplot(mapping = aes(x = ECON1_W110, y = avg, fill = Party)) +
  geom_col(position = "dodge") +
  labs(title = "Average Responses by Party, Gender, and ECON1_W110",
       x = "ECON1_W110",
       y = "Proportion")
avg_response_110
```
```{r}
##trump
avg_response_52_2 <- summdat2 %>%
  group_by(ECON1B_W52, Gender, Party) %>%
  summarize(count1 = n()) %>%
  mutate(avg = count1 / sum(count1)) %>%
  ggplot(mapping = aes(x = ECON1B_W52, y = avg, fill = Party)) +
  geom_col(position = "dodge") +
  labs(title = "Average Responses by Party, Gender, and ECON1B_W52",
       x = "ECON1B_W52",
       y = "Proportion")
avg_response_52_2
```

```{r}
##biden
avg_response_110_2 <- summdat2 %>%
  group_by(ECON1B_W110, Gender, Party) %>%
  summarize(count1 = n()) %>%
  mutate(avg = count1 / sum(count1)) %>%
  ggplot(mapping = aes(x = ECON1B_W110, y = avg, fill = Party)) +
  geom_col(position = "dodge") +
  labs(title = "Average Responses by Party, Gender, and ECON1B_W110",
       x = "ECON1B_W110",
       y = "Proportion")
avg_response_110_2
```







