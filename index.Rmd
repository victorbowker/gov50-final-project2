---
title: "Gov 50 Final Project"
author: "Victor Bowker"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---

---
output:
  pdf_document: default
  html_document: default
---
##prep work
```{r}
##loading data and identifying data set
library(tidyverse)
library(haven)
dat <- read_sav("W110_Jun22/ATP W110.sav")

```
```{r}
##mutating to simplify label names
var <- dat |>
  mutate(
    Party = if_else(PARTY_W110 == 1, "Republican", "Democrat"), 
    Approval = if_else(POL1JB_W110 == 1, "Approve", "Disapprove"),
    Gender = if_else(F_GENDER == 1, "Man", "Woman"),
    Age = if_else(
      F_AGECAT == 1, "18-29",
      if_else(F_AGECAT == 2, "30-49",
        if_else(F_AGECAT == 3, "50-64",
          if_else(F_AGECAT == 4, "65+", "N/A")))))
```
```{r}
bidenvar <-
  var |>
  group_by(Party, Gender) |>
  count(Approval) |>
  mutate(pct = n / sum(n) *100 )

bidenvar |>
ggplot(mapping = aes(x = Approval, y = pct, fill = Party)) +
geom_col(position = "dodge") +
    facet_grid(rows = vars(Gender)) +
scale_fill_manual(values = c(Democrat = "steelblue", Republican = "indianred")) +
    labs(title = "Approval Ratings of President Joe Biden",
       x = "Thoughts on the President",
       y = "Percentage") 

knitr::kable(bidenvar)
```
```{r}
var_biden <-
var |>
filter(ECON1_W110 == 1 | ECON1_W110 == 2 | ECON1_W110 == 3 | ECON1_W110 == 4 | ECON1_W110 == 5 |
ECON1B_W110 == 1 | ECON1B_W110 == 2 | ECON1B_W110 == 3 | ECON1B_W110 == 4) |>
mutate(ECON1_W110 = if_else(ECON1_W110 == 1, "Excellent",
if_else(ECON1_W110 == 2, "Good",
if_else(ECON1_W110 == 3, "Only Fair",
if_else(ECON1_W110 == 4, "Poor", "No Change"))))) |>
mutate(ECON1B_W110 = if_else(ECON1B_W110 == 1, "Better",
if_else(ECON1B_W110 == 2, "Worse",          
if_else(ECON1B_W110 == 3, "About Same", "Unsure")))) |>
group_by(Party, Gender) |>
count(ECON1_W110) |>
mutate(pct = n / sum(n) *100 )


bruh <- 
var_biden |>
ggplot(mapping = aes(x = ECON1_W110, y = pct, fill = Party)) +
geom_col(position = "dodge") +
      facet_grid(rows = vars(Gender)) +
scale_fill_manual(values = c(Democrat = "steelblue", Republican = "indianred")) +
labs(title = "Thoughts on Economy Under Biden",
x = "Feelings Towards Economy",
y = "Percentage") 

bruh




knitr::kable(var_biden)

```

dat1 <- read_sav("W110_Jun22/ATP W110.sav")
altdat1 <- read_sav("W52_Jul19/ATP W52.sav")

```{r}
##loading data and identifying data sets
library(tidyverse)
library(haven)
altdat <- read_sav("W52_Jul19/ATP W52.sav")

```
```{r}
##mutating to simplify label names
var <- 
  altdat |>
mutate(
    Party = if_else(F_PARTY_FINAL == 1, "Republican", "Democrat"), 
    Gender = if_else(F_SEX == 1, "Man", "Woman"),
    Approval = if_else(POL1DT_W52 == 1, "Approve", "Disapprove"),
    Age = if_else(
      F_AGECAT == 1, "18-29",
      if_else(F_AGECAT == 2, "30-49",
        if_else(F_AGECAT == 3, "50-64",
          if_else(F_AGECAT == 4, "65+", "N/A")))))


```
```{r}
trumpvar <-
  var |>
  group_by(Party, Gender) |>
  count(Approval) |>
  mutate(pct = n / sum(n) *100 )

trumpvar |>
ggplot(mapping = aes(x = Approval, y = pct, fill = Party)) +
geom_col(position = "dodge") +
      facet_grid(rows = vars(Gender)) +
scale_fill_manual(values = c(Democrat = "steelblue", Republican = "indianred")) +
    labs(title = "Approval Ratings of President Donald Trump",
       x = "Approval",
       y = "Percentage") 

knitr::kable(trumpvar)
```
```{r}
var_trump <-
var |>
filter(ECON1_W52 == 1 | ECON1_W52 == 2 | ECON1_W52 == 3 | ECON1_W52 == 4 | ECON1_W52 == 5 |
ECON1B_W52 == 1 | ECON1B_W52 == 2 | ECON1B_W52 == 3 | ECON1B_W52 == 4) |>
mutate(ECON1_W52 = if_else(ECON1_W52 == 1, "Excellent",
if_else(ECON1_W52 == 2, "Good",
if_else(ECON1_W52 == 3, "Only Fair",
if_else(ECON1_W52 == 4, "Poor", "No Change"))))) |>
mutate(ECON1B_W52 = if_else(ECON1B_W52 == 1, "Better",
if_else(ECON1B_W52 == 2, "Worse",          
if_else(ECON1B_W52 == 3, "About Same", "Unsure")))) |>
group_by(Party, Gender) |>
count(ECON1_W52) |>
mutate(pct = n / sum(n) *100 )


bruh <- 
var_trump |>
ggplot(mapping = aes(x = ECON1_W52, y = pct, fill = Party)) +
geom_col(position = "dodge") +
      facet_grid(rows = vars(Gender)) +
scale_fill_manual(values = c(Democrat = "steelblue", Republican = "indianred")) +
labs(title = "Thoughts on Economy Under Trump",
x = "Feelings Towards Economy",
y = "Percentage") 

bruh
 
knitr::kable(var_trump)

```






